---
title: "Kino _Green_Space"
author: "Kino Watanabe"
date: "2025-11-13"
output: html_document
---

```{r}
library(tidyverse)
library(tidycensus)
library(sf)
library(tigris)

```

```{r}
parks_df =
  read_csv("Data Folder/Parks_Properties_Oct2025.csv")

shooting25_df =
  read_csv("Data Folder/Shooting_2025.csv")
```

```{r}


# Convert WKT to sf object
parks_sf <- st_as_sf(parks_df, wkt = "multipolygon", crs = 4326)

# Get Manhattan tracts (you can add other boroughs if needed)
manhattan_tracts <- tracts(
  state = "NY",
  county = "New York",  # Manhattan
  year = 2020,
  cb = TRUE
)

# Transform CRS to match
parks_sf <- st_transform(parks_sf, st_crs(manhattan_tracts))

# Spatial join: assign each park to a tract
parks_tracts <- st_join(parks_sf, manhattan_tracts, join = st_intersects)

# Summarize number of parks per tract
parks_per_tract <- parks_tracts %>%
  st_drop_geometry() %>%
  group_by(GEOID) %>%
  summarise(num_parks = n())

# Merge counts with tract shapefile
manhattan_tracts <- left_join(manhattan_tracts, parks_per_tract, by = "GEOID")

# Map results
leaflet(manhattan_tracts) %>%
  addTiles() %>%
  addPolygons(
    fillColor = ~colorQuantile("Greens", num_parks)(num_parks),
    color = "gray", weight = 1,
    fillOpacity = 0.6,
    popup = ~paste("GEOID:", GEOID, "<br>Parks:", num_parks)
  ) %>%
  addPolygons(data = parks_sf, fill = TRUE, color = "darkgreen", weight = 1, opacity = 0.4)



```

